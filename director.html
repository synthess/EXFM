<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EXFM 감독 검색기</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 80%;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        header h1 {
            color: #333;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .filters div {
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 200px;
        }

        .filters label {
            font-size: 14px;
            margin-bottom: 5px;
        }

        .filters input, .filters select {
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .filters button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            flex-grow: 1;
        }

        .filters button:hover {
            background-color: #0056b3;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table th, table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        @media (max-width: 768px) {
            .filters {
                flex-direction: column;
                gap: 10px;
            }

            .filters div {
                width: 100%;
            }

            .filters button {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>감독 검색</h1>
        </header>

        <div class="filters">
            <div>
                <label for="coachNameSearch">감독명 검색</label>
                <input type="text" id="coachNameSearch" placeholder="감독명을 입력하세요">
            </div>
    
            <div>
                <label for="nationalitySearch">국적</label>
                <select id="nationalitySearch">
                    <option value="">전체</option>
                    <option value='남아프리카공화국'>남아프리카공화국</option>
                    <option value='네덜란드'>네덜란드</option>
                    <option value='노르웨이'>노르웨이</option>
                    <option value='덴마크'>덴마크</option>
                    <option value='독일'>독일</option>
                    <option value='루마니아'>루마니아</option>
                    <option value='멕시코'>멕시코</option>
                    <option value='미국'>미국</option>
                    <option value='베네수엘라'>베네수엘라</option>
                    <option value='벨기에'>벨기에</option>
                    <option value='벨라루스'>벨라루스</option>
                    <option value='북아일랜드'>북아일랜드</option>
                    <option value='불가리아'>불가리아</option>
                    <option value='브라질'>브라질</option>
                    <option value='세르비아'>세르비아</option>
                    <option value='스웨덴'>스웨덴</option>
                    <option value='스위스'>스위스</option>
                    <option value='스코틀랜드'>스코틀랜드</option>
                    <option value='스페인'>스페인</option>
                    <option value='슬로바키아'>슬로바키아</option>
                    <option value='슬로베니아'>슬로베니아</option>
                    <option value='아르메니아'>아르메니아</option>
                    <option value='아르헨티나'>아르헨티나</option>
                    <option value='아이슬란드'>아이슬란드</option>
                    <option value='아일랜드'>아일랜드</option>
                    <option value='오스트리아'>오스트리아</option>
                    <option value='우루과이'>우루과이</option>
                    <option value='우크라이나'>우크라이나</option>
                    <option value='이스라엘'>이스라엘</option>
                    <option value='이탈리아'>이탈리아</option>
                    <option value='일본'>일본</option>
                    <option value='잉글랜드'>잉글랜드</option>
                    <option value='체코'>체코</option>
                    <option value='칠레'>칠레</option>
                    <option value='코스타리카'>코스타리카</option>
                    <option value='콜롬비아'>콜롬비아</option>
                    <option value='크로아티아'>크로아티아</option>
                    <option value='투르크메니스탄'>투르크메니스탄</option>
                    <option value='튀르키예'>튀르키예</option>
                    <option value='페루'>페루</option>
                    <option value='포르투갈'>포르투갈</option>
                    <option value='프랑스'>프랑스</option>
                    <option value='핀란드'>핀란드</option>
                    <option value='헝가리'>헝가리</option>
                    <option value='호주'>호주</option>
                </select>
            </div>

            <div>
                <label for="tacticStyle">전술 스타일</label>
                <select id="tacticStyle">
                    <option value="">전체</option>
                    <option value="None">None</option>
                    <option value="측면플레이">측면플레이</option>
                    <option value="티키타카">티키타카</option>
                    <option value="전진티키타카">전진티키타카</option>
                    <option value="점유율중시">점유율중시</option>
                    <option value="길게차기">길게차기</option>
                    <option value="유연한역습">유연한역습</option>
                    <option value="빠른역습">빠른역습</option>
                    <option value="게겐프레스">게겐프레스</option>
                </select>
            </div>

            <div>
                <label for="preferredFormation">선호 포메이션</label>
                <select id="preferredFormation">
                    <option value="">전체</option>
                    <option value='5-2-1-2 DM AM'>5-2-1-2 DM AM</option>
                    <option value='5-3-2 DM WB'>5-3-2 DM WB</option>
                    <option value='4-2-3-1 DM AM 넓게'>4-2-3-1 DM AM 넓게</option>
                    <option value='4-4-2 Flat'>4-4-2 Flat</option>
                    <option value='4-3-3 DM 넓게'>4-3-3 DM 넓게</option>
                    <option value='4-2-4 DM 넓게'>4-2-4 DM 넓게</option>
                    <option value='5-2-3 DM 넓게'>5-2-3 DM 넓게</option>
                    <option value='4-4-2 다이아몬드 좁게'>4-4-2 다이아몬드 좁게</option>
                    <option value='5-2-2-1 DM AM'>5-2-2-1 DM AM</option>
                    <option value='4-3-2-1 DM AM 좁게'>4-3-2-1 DM AM 좁게</option>
                    <option value='4-2-2-2 DM AM 좁게'>4-2-2-2 DM AM 좁게</option>
                </select>
            </div>
            <div></div>    
            <div>
                <label for="abilityMin">어빌 최소값</label>
                <input type="number" id="abilityMin" min="0" placeholder="최소 어빌">
            </div>
            
            <div>
                <label for="abilityMax">어빌 최대값</label>
                <input type="number" id="abilityMax" min="0" placeholder="최대 어빌">
            </div>
    
            <div>
                <label for="potentialMin">포텐 최소값</label>
                <input type="number" id="potentialMin" min="0" placeholder="최소 포텐">
            </div>
    
            <div>
                <label for="potentialMax">포텐 최대값</label>
                <input type="number" id="potentialMax" min="0" placeholder="최대 포텐">
            </div>
        </div>

        <table id="coachesTable">
            <thead>
                <tr>
                    <th>감독명</th>
                    <th>국적</th>
                    <th>어빌</th>
                    <th>포텐</th>
                    <th>전술 스타일</th>
                    <th>포메이션1</th>
                    <th>포메이션2</th>
                </tr>
            </thead>
            <tbody>
                <!-- 동적으로 결과가 삽입됩니다 -->
            </tbody>
        </table>
    </div>


<script>
    // 데이터
    let data = []; // JSON 데이터를 저장할 변수

    $(document).ready(function() {
        // input 및 select 변경 시 필터 적용
        $("input").on("keyup", applyFilters);
        $("select").on("change", applyFilters);
    });

    // JSON 파일 URL 배열 (Google Drive 파일은 직접 fetch 불가능)
    const jsonUrls = [
        "https://synthess.github.io/EXFM/json/250318_director.json"
    ];

    // JSON 파일 불러오기
    async function loadJsonFiles(urls) {
        try {
            const responses = await Promise.all(urls.map(url => fetch(url)));
            const jsonData = await Promise.all(responses.map(res => res.json()));

            data = jsonData[0]; // 첫 번째 JSON 데이터를 data 변수에 저장
            // 초기 데이터 표시
            displayData(data);
        } catch (error) {
            console.error("JSON 파일을 불러오는 중 오류 발생:", error);
        }
    }

    // JSON 파일 로드 실행
    loadJsonFiles(jsonUrls);

    // 테이블에 데이터 렌더링
    function displayData(coaches) {
        const tableBody = document.querySelector("#coachesTable tbody");
        tableBody.innerHTML = ""; // 기존 내용 지우기

        coaches.forEach(coach => {
            const row = document.createElement("tr");
            row.innerHTML = `
                        <td>${coach.name}</td>
                        <td>${coach.national}</td>
                        <td>${coach.ability}</td>
                        <td>${coach.potential}</td>
                        <td>${coach.style == 'None' ? '' : coach.style}</td>
                        <td>${coach.formation1}</td>
                        <td>${coach.formation2}</td>
                `;
            tableBody.appendChild(row);
        });
    }

    // 데이터 필터링
    function applyFilters() {
        let nameSearch = $("#coachNameSearch").val().toLowerCase();
        let nationality = $("#nationalitySearch").val().toLowerCase();
        let abilityMin = parseInt($("#abilityMin").val()) || 0;
        let abilityMax = parseInt($("#abilityMax").val()) || 200;
        let potentialMin = parseInt($("#potentialMin").val()) || 0;
        let potentialMax = parseInt($("#potentialMax").val()) || 200;
        let tactic = $("#tacticStyle").val();
        let formation1 = $("#preferredFormation").val();
        let formation2 = $("#preferredFormation").val();

        var filteredData = data.filter(coach => {

            // 이름 검색 필터링 (한글 및 영문 포함)
            if (nameSearch && !coach.name.includes(nameSearch)) return false;

            // 어빌 필터링
            if (abilityMin && coach.ability < abilityMin) return false;
            if (abilityMax && coach.ability > abilityMax) return false;

            // 포텐 필터링
            if (potentialMin && coach.potential < potentialMin) return false;
            if (potentialMax && coach.potential > potentialMax) return false;

            // 국적 필터링
            if (nationality && coach.national !== nationality) return false;

            // 전술 스타일 필터링
            if (tactic && coach.style !== tactic) return false;

            // 포메이션 필터링
            if (formation1 && formation2 && !coach.formation1.includes(formation1) && !coach.formation2.includes(formation2)) return false;

            return true;
            });

        // 필터링된 데이터 표시
        displayData(filteredData);
    }
</script>

</body>
</html>
